<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbox</title>
</head>
<body>
    <div class="chat-container">
        <div class="chat-messages" id="chatMessages">
        </div>
    </div>

    <script>
        const framework = new Getmessage({ messageInterval: 5000 });
        const chatMessages = document.getElementById('chatMessages');

        framework.addListener((response) => {
            response.forEach(message => {
                const { authorDetails, snippet } = message;
                const messageElement = document.createElement('div');
                messageElement.className = 'chat-message';

                const img = document.createElement('img');
                img.src = authorDetails.profileImageUrl || 'https://via.placeholder.com/40';
                img.alt = authorDetails.displayName;

                const content = document.createElement('div');
                content.className = 'message-content';

                const author = document.createElement('span');
                author.className = 'author-name';
                if (authorDetails.isChatModerator) author.classList.add('moderator');
                if (authorDetails.isChatOwner) author.classList.add('owner');
                author.textContent = authorDetails.displayName;

                const text = document.createElement('div');
                text.className = 'message-text';
                text.textContent = snippet.textMessageDetails?.messageText || '';

                content.appendChild(author);
                content.appendChild(text);
                messageElement.appendChild(img);
                messageElement.appendChild(content);
                chatMessages.appendChild(messageElement);

                chatMessages.scrollTop = chatMessages.scrollHeight;
            });

            console.log('Messages received:', {
                count: response.length,
                timestamp: new Date().toISOString()
            });
        });

        framework.init();

        setTimeout(() => {
            framework.setMessageInterval(10000);
        }, 10000);
    </script>
</body>
</html>